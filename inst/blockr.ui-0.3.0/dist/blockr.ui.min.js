var e=()=>{Shiny.addCustomMessageHandler("bind-network-keyboard-shortcuts",t=>{let d=HTMLWidgets.find(t.id).network;$(document).on("keydown",i=>{i.shiftKey&&i.keyCode==69&&(d.addEdgeMode(),$("button.vis-back").hide(),$(".vis-separator-line").hide())}),$(document).on("keydown",i=>{i.key==="Escape"&&(d.disableEditMode(),d.enableEditMode(),$(".vis-close").hide(),$(".vis-edit").hide(),$(".vis-separator-line").hide())})})};var a=()=>{Shiny.addCustomMessageHandler("hide-vis-dropdown",t=>{$(t).css("visibility","hidden")}),Shiny.addCustomMessageHandler("toggle-manipulation-ui",t=>{$(".vis-close").hide(),$(".vis-edit").hide(),$(".vis-separator-line").hide(),t.value?$(".vis-manipulation").show():$(".vis-manipulation").hide()}),Shiny.addCustomMessageHandler("hide-sidebars-toggles",t=>{$(`button[aria-controls="${t.ns}-dashboard"]`).css("visibility","hidden"),$(`button[aria-controls="${t.ns}-properties"]`).css("visibility","hidden")})};var b=t=>{var d=HTMLWidgets.find("#"+t),i;return typeof d<"u"&&(i=d.getWidget()),i},s=()=>{Shiny.addCustomMessageHandler("add-grid-widget",t=>{var d=b(t.id);typeof d<"u"&&(t.data.content=`<div
              id="grid-stack-item-content-${t.data.id}"
              class="bg-white p-2 border rounded-4">
            </div>`,d.addWidget(t.data),$(`#grid-stack-item-content-${t.data.id}`).append($(`#${t.data.id}`)),$(`#${t.data.id}`).is(":hidden")&&$(`#${t.data.id}`).show())}),Shiny.addCustomMessageHandler("move-widget-to-sidebar",t=>{$(t.id).append($(t.block_id))}),Shiny.addCustomMessageHandler("update-grid-zoom",t=>{$(t.id).css("zoom",t.zoom)})};var r=(t,d)=>{let i={x:d.clientX,y:d.clientY};Shiny.setInputValue(t,i,{priority:"event"})},o=()=>{Shiny.addCustomMessageHandler("capture-mouse-position",t=>{document.addEventListener("contextmenu",d=>{r(t,d)})}),$("body").click(t=>{$(t.target).closest(".node-menu-card").length===0&&$(".node-menu-card").hide()}),Shiny.addCustomMessageHandler("show-node-menu",t=>{if($(`#${t.id}`).length===0){let n=t.id.split(t.ns)[1],c=`<div class="card node-menu-card" style="width: 18rem; position: absolute;" id="${t.id}">
              <div class="card-header"><h5 class="card-title">Block ${n} options</h5></div>
              <div class="card-body">
                <div class="bslib-input-switch form-switch form-check">
                  <input 
                    id="${t.id}-add_to_grid"
                    class="form-check-input"
                    type="checkbox"
                    role="switch">
                  <label class="form-check-label" for="${t.id}-add_to_grid">
                    <span>Use in dashboard?</span>
                  </label>
                </div>
                <div class="d-grid gap-2 mx-auto">
                  <button class="btn action-button btn-light" id="${t.id}-append_block" type="button">
                    <i class="fas fa-circle-plus" role="presentation" aria-label="circle-plus icon"></i>
                    Append block
                  </button>
                  <button class="btn action-button btn-danger" id="${t.id}-remove_block" type="button">
                    <i class="fas fa-trash" role="presentation" aria-label="trash icon"></i>
                    Remove block
                  </button>
                  <button class="btn action-button btn-light" id="${t.id}-remove_from_stack" type="button">
                    <i class="fas fa-object-ungroup" role="presentation" aria-label="object ungroup icon"></i>
                    Remove from stack
                  </button>
                  <div class="row g-3">
                    <div class="col-auto">
                      <select class="form-select" id="${t.id}-add_to_stack_selected"></select>
                    </div>
                    <div class="col-auto">
                      <button class="btn action-button btn-light" id="${t.id}-add_to_stack" type="button">
                        <i class="fas fa-object-group" role="presentation" aria-label="object group icon"></i>
                        Add to stack
                      </button>
                    </div>
                  </div>
                  
                </div>
              </div>
            </div>`;$("body").append(c),t.value&&$(`#${t.id}-add_to_grid`).attr("checked",""),$(`#${t.id} .btn-group`).click(()=>{$(".node-menu-card").hide()}),Shiny.bindAll($(`#${t.id}`))}if($(`#${t.id}-remove_from_stack`).attr("disabled",!t.has_stack),$(`#${t.id}-add_to_stack`).attr("disabled",t.has_stack||t.stacks.length===0),t.stacks.length>0){select=document.getElementById(`${t.id}-add_to_stack_selected`),$(`#${t.id}-add_to_stack_selected`).find("option").remove();for(var d=0;d<t.stacks.length;d++){var i=document.createElement("option");i.value=t.stacks[d],i.innerHTML=t.stacks[d],select.appendChild(i)}}$(`#${t.id}`).show().css({top:t.coords.y,left:t.coords.x})})};var l=()=>{Shiny.addCustomMessageHandler("toggle-view",t=>{t.val?($(t.id).parent(".bslib-sidebar-layout").css("--_sidebar-width","100%"),$(t.id).css("border-left","none")):($(t.id).parent(".bslib-sidebar-layout").css("--_sidebar-width","75%"),$(t.id).css("border-left","var(--_vert-border)"))})};$(function(){e(),a(),s(),o(),l(),Shiny.addCustomMessageHandler("reset-node-selection",t=>{HTMLWidgets.find(t.id).network.unselectAll()})});
