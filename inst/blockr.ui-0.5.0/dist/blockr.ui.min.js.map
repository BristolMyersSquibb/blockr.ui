{
  "version": 3,
  "sources": ["../../../srcjs/keybindings.js", "../../../srcjs/init-network.js", "../../../srcjs/move-blocks.js", "../../../srcjs/node-menu.js", "../../../srcjs/viewer-mode.js", "../../../srcjs/main.js"],
  "sourcesContent": ["export const setKeyBindings = () => {\n  Shiny.addCustomMessageHandler(\"bind-network-keyboard-shortcuts\", (m) => {\n\n    let widget = HTMLWidgets.find(m.id).network;\n\n    $(document).on(\"keydown\", (e) => {\n      // Shift + E\n      if (e.shiftKey && e.keyCode == 69) {\n        widget.addEdgeMode();\n        $(\"button.vis-back\").hide();\n        $(\".vis-separator-line\").hide();\n      }\n    })\n\n    $(document).on(\"keydown\", (e) => {\n      // esc\n      if (e.key === \"Escape\") {\n        widget.disableEditMode();\n        widget.enableEditMode();\n        $(\".vis-close\").hide();\n        $(\".vis-edit\").hide();\n        $(\".vis-separator-line\").hide();\n      }\n    })\n  })\n}\n", "export const initNetwork = () => {\n  // Hide visNetwork selection dropdown\n  Shiny.addCustomMessageHandler(\"hide-vis-dropdown\", (m) => {\n    $(m).css(\"visibility\", \"hidden\")\n  })\n\n  // Handle manipulation ui visibility\n  Shiny.addCustomMessageHandler(\"toggle-manipulation-ui\", (m) => {\n    $(\".vis-close\").hide();\n    $(\".vis-edit\").hide();\n    $(\".vis-separator-line\").hide();\n    if (m.value) {\n      $(\".vis-manipulation\").show();\n    } else {\n      $(\".vis-manipulation\").hide();\n    }\n  })\n\n  // Hide sidebar toggles\n  Shiny.addCustomMessageHandler(\"hide-sidebars-toggles\", (m) => {\n    $(`button[aria-controls=\\\"${m.ns}-dashboard\\\"]`).css('visibility', 'hidden');\n    $(`button[aria-controls=\\\"${m.ns}-properties\\\"]`).css('visibility', 'hidden');\n  });\n} \n", "const getWidget = (id) => {\n  var htmlWidgetsObj = HTMLWidgets.find(\"#\" + id);\n  var widgetObj;\n  if (typeof htmlWidgetsObj !== \"undefined\") {\n    widgetObj = htmlWidgetsObj.getWidget();\n  }\n  return widgetObj;\n}\n\nexport const setupBlocksGrid = () => {\n  Shiny.addCustomMessageHandler(\"add-grid-widget\", (obj) => {\n    var grid = getWidget(obj.id);\n    if (typeof grid != \"undefined\") {\n      obj.data.content = `<div\n              id=\"grid-stack-item-content-${obj.data.id}\"\n              class=\"bg-white p-2 border rounded-4\">\n            </div>`\n      // Initialize the widget\n      grid.addWidget(obj.data);\n      // Move element from the sidebar to the grid slot\n      $(`#grid-stack-item-content-${obj.data.id}`).append($(`#${obj.data.id}`));\n      // If the element is hidden by shinyjs, show it\n      if ($(`#${obj.data.id}`).is(\":hidden\")) {\n        $(`#${obj.data.id}`).show();\n      }\n    }\n  });\n\n  Shiny.addCustomMessageHandler('move-widget-to-sidebar', (m) => {\n    $(m.id).append($(m.block_id));\n  });\n\n  // Handle grid zoom\n  Shiny.addCustomMessageHandler('update-grid-zoom', (m) => {\n    $(m.id).css('zoom', m.zoom);\n  });\n\n  // Manage dock mode\n  Shiny.addCustomMessageHandler(\"move-block-in-dock\", (m) => {\n    let dock = HTMLWidgets.find(m.dock_id);\n    // Set active panel so that it is mounted in the DOM\n    // before moving it to sidebar (if there are tabs\n    // only the active tabs is rendered in the DOM)\n    dock.getWidget().getPanel(m.panel_id).api.setActive();\n    $(`${m.dock_id}-${m.panel_id}`).append($(m.block_id));\n    if ($(m.block_id).is(\":hidden\")) {\n      $(m.block_id).show();\n    }\n  })\n\n  Shiny.addCustomMessageHandler(\"remove-block-from-dock\", (m) => {\n    let dock = HTMLWidgets.find(m.dock_id);\n    // Set active panel so that it is mounted in the DOM\n    // before moving it to sidebar (if there are tabs\n    // only the active tabs is rendered in the DOM)\n    dock.getWidget().getPanel(m.panel_id).api.setActive();\n    $(m.id).append($(`${m.dock_id}-${m.panel_id} > * `));\n  })\n} \n", "const captureMouseLocation = (id, event) => {\n  let location = { x: event.clientX, y: event.clientY };\n  Shiny.setInputValue(\n    id,\n    location,\n    { priority: 'event' }\n  );\n}\n\nexport const manageNodeMenu = () => {\n  Shiny.addCustomMessageHandler(\"capture-mouse-position\", (m) => {\n    //document.addEventListener('click', (e) => {\n    //  captureMouseLocation(m, e)\n    //});\n    document.addEventListener('contextmenu', (e) => {\n      captureMouseLocation(m, e)\n    });\n  })\n\n  // Hide node menu whenever we click outside\n  $('body').click((e) => {\n    if ($(e.target).closest('.node-menu-card').length === 0) {\n      $('.node-menu-card').hide();\n    }\n  });\n\n  Shiny.addCustomMessageHandler(\"show-node-menu\", (m) => {\n    // Create element if needed\n    if ($(`#${m.id}`).length === 0) {\n      let shortId = m.id.split(m.ns)[1];\n      let dropTag = `<div class=\"card node-menu-card\" style=\"width: 18rem; position: absolute;\" id=\"${m.id}\">\n              <div class=\"card-header\"><h5 class=\"card-title\">Block ${shortId} options</h5></div>\n              <div class=\"card-body\">\n                <div class=\"d-grid gap-2 mx-auto\">\n                  <div class=\"bslib-input-switch form-switch form-check\">\n                    <input \n                      id=\"${m.id}-add_to_grid\"\n                      class=\"form-check-input\"\n                      type=\"checkbox\"\n                      role=\"switch\">\n                    <label class=\"form-check-label\" for=\"${m.id}-add_to_grid\">\n                      <span>Use in dashboard?</span>\n                    </label>\n                  </div>\n                  <button class=\"btn action-button btn-light\" id=\"${m.id}-append_block\" type=\"button\">\n                    <i class=\"fas fa-circle-plus\" role=\"presentation\" aria-label=\"circle-plus icon\"></i>\n                    Append block\n                  </button>\n                  <button class=\"btn action-button btn-danger\" id=\"${m.id}-remove_block\" type=\"button\">\n                    <i class=\"fas fa-trash\" role=\"presentation\" aria-label=\"trash icon\"></i>\n                    Remove block\n                  </button>\n                  <button class=\"btn action-button btn-light\" id=\"${m.id}-remove_from_stack\" type=\"button\">\n                    <i class=\"fas fa-object-ungroup\" role=\"presentation\" aria-label=\"object ungroup icon\"></i>\n                    Remove from stack\n                  </button>\n                  <div class=\"row g-3\">\n                    <div class=\"col-auto\">\n                      <select class=\"form-select\" id=\"${m.id}-add_to_stack_selected\"></select>\n                    </div>\n                    <div class=\"col-auto\">\n                      <button class=\"btn action-button btn-light\" id=\"${m.id}-add_to_stack\" type=\"button\">\n                        <i class=\"fas fa-object-group\" role=\"presentation\" aria-label=\"object group icon\"></i>\n                        Add to stack\n                      </button>\n                    </div>\n                  </div>\n                  \n                </div>\n              </div>\n            </div>`\n      $('body').append(dropTag);\n\n      // Ensure we account for the switch grid state if it exists\n      // so that the 2 switches start in sync.\n      if (m.value) {\n        $(`#${m.id}-add_to_grid`).attr(\"checked\", \"\")\n      }\n\n      $(`#${m.id} .btn-group`).click(() => {\n        $('.node-menu-card').hide();\n      });\n\n      Shiny.bindAll($(`#${m.id}`));\n    }\n\n    // Toggle remove from stack button\n    $(`#${m.id}-remove_from_stack`).attr(\"disabled\", !m.has_stack);\n    // Toggle add to stack button\n    $(`#${m.id}-add_to_stack`).attr(\"disabled\", m.has_stack || m.stacks.length === 0);\n\n    // Populate select with choices\n    if (m.stacks.length > 0) {\n      select = document.getElementById(`${m.id}-add_to_stack_selected`);\n      $(`#${m.id}-add_to_stack_selected`).find(\"option\").remove();\n      for (var i = 0; i < m.stacks.length; i++) {\n        var opt = document.createElement(\"option\");\n        opt.value = m.stacks[i];\n        opt.innerHTML = m.stacks[i];\n        select.appendChild(opt);\n      }\n    }\n\n    // Show dropdown\n    $(`#${m.id}`).show().css({ 'top': m.coords.y, 'left': m.coords.x });\n  });\n}\n", "export const handleViewerMode = () => {\n  // Viewer mode\n  Shiny.addCustomMessageHandler('toggle-view', (m) => {\n    if (!m.val) {\n      $(m.id)\n        .parent('.bslib-sidebar-layout')\n        .css('--_sidebar-width', '75%');\n      $(m.id).css('border-left', 'var(--_vert-border)');\n    } else {\n      $(m.id)\n        .parent('.bslib-sidebar-layout')\n        .css('--_sidebar-width', '100%');\n      $(m.id).css('border-left', 'none');\n    }\n  });\n} \n", "import \"../styles/main.scss\";\nimport { setKeyBindings } from \"./keybindings.js\";\nimport { initNetwork } from \"./init-network.js\";\nimport { setupBlocksGrid } from \"./move-blocks.js\";\nimport { manageNodeMenu } from \"./node-menu.js\";\nimport { handleViewerMode } from \"./viewer-mode.js\";\n\n$(function () {\n  setKeyBindings();\n  initNetwork();\n  setupBlocksGrid();\n  manageNodeMenu();\n  handleViewerMode();\n  // Unselect all nodes when removing a block.\n  Shiny.addCustomMessageHandler(\"reset-node-selection\", (m) => {\n    let widget = HTMLWidgets.find(m.id).network;\n    widget.unselectAll();\n  })\n});\n"],
  "mappings": "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",
  "names": ["setKeyBindings", "m", "widget", "initNetwork", "m", "getWidget", "id", "htmlWidgetsObj", "widgetObj", "setupBlocksGrid", "obj", "grid", "m", "captureMouseLocation", "id", "event", "location", "manageNodeMenu", "m", "e", "shortId", "dropTag", "i", "opt", "handleViewerMode", "m", "setKeyBindings", "initNetwork", "setupBlocksGrid", "manageNodeMenu", "handleViewerMode", "m"]
}
